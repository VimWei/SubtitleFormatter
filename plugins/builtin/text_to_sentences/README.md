# TextToSentencesPlugin - 文本转句子插件

## 功能描述

TextToSentencesPlugin 是 SubtitleFormatter 的文本转句子插件，将连续文本按句分割，每句一行。该插件使用正则表达式进行句子分割，支持缩写词识别，确保分割的准确性。

## 核心功能

### 1. 智能句子分割
- 基于正则表达式的句子分割
- 支持多种句子结束标点符号（. ! ?）
- 可配置的标点符号列表

### 2. 缩写词识别
- 自动识别常见缩写词（Mr., Mrs., Dr., Prof.等）
- 避免在缩写词后误分割
- 支持单字母缩写识别（如 U.S.）

### 3. 空白字符处理
- 统一换行符为空格
- 合并多个连续空格
- 规范化文本格式

### 4. 空句子过滤
- 自动移除空句子
- 清理空白内容
- 确保输出质量

## 配置选项

```json
{
    "enabled": true,
    "sentence_endings": [".", "!", "?"],
    "abbreviation_patterns": ["Mr.", "Mrs.", "Dr.", "Prof.", "Inc.", "Ltd.", "Co.", "Corp."],
    "normalize_whitespace": true,
    "remove_empty_sentences": true,
    "filter_ellipsis_only": false
}
```

### 配置说明

- `enabled`: 是否启用文本转句子功能
- `sentence_endings`: 句子结束标点符号列表
- `abbreviation_patterns`: 常见缩写词模式列表
- `normalize_whitespace`: 是否规范化空白字符
- `remove_empty_sentences`: 是否移除空句子
- `filter_ellipsis_only`: 是否过滤只包含省略号的句子

## 使用示例

### 输入输出示例

**输入**:
```
Hello world. This is a test! How are you?
```

**输出**:
```
Hello world.
This is a test!
How are you?
```

**输入**:
```
Dr. Smith is here. He works at Inc. Corp.
```

**输出**:
```
Dr. Smith is here.
He works at Inc. Corp.
```

### 处理效果

1. **句子分割**: 在句号、问号、感叹号后分割
2. **缩写词保护**: 避免在 Dr., Inc. 等缩写后误分割
3. **格式标准化**: 每行一个句子，便于后续处理

## 技术实现

### 核心算法
- **正则表达式分割**: 使用 `([.!?]+)\s+` 模式分割句子
- **缩写词检测**: 基于预定义模式和单字母缩写规则
- **空白字符处理**: 统一换行符和空格

### 处理流程
1. **预处理**: 规范化空白字符
2. **句子分割**: 使用正则表达式分割
3. **缩写词检查**: 识别并保护缩写词
4. **后处理**: 过滤空句子，格式化输出

### 性能特点
- 轻量级实现，无外部依赖
- 处理速度快，适合批量操作
- 内存占用低

## 缩写词处理

### 支持的缩写词类型
1. **常见缩写**: Mr., Mrs., Dr., Prof., Inc., Ltd., Co., Corp.
2. **单字母缩写**: U.S., A.D., B.C. 等
3. **可配置模式**: 支持自定义缩写词列表

### 识别规则
- 检查文本末尾是否匹配已知缩写词模式
- 识别单字母+空格+大写字母+句号的模式
- 避免在缩写词后误分割句子

## 集成方式

该插件作为 SubtitleFormatter 插件系统的一部分，通过以下方式集成：

1. **插件注册**: 自动在 `builtin` 命名空间下注册
2. **配置管理**: 通过统一的配置系统管理参数
3. **依赖注入**: 自动注入日志和配置服务
4. **生命周期**: 支持插件的加载、初始化和清理

## 扩展性

该插件设计为可扩展的，支持：

- 自定义句子结束标点符号
- 添加新的缩写词模式
- 扩展空白字符处理规则
- 集成其他句子分割算法

## 使用场景

### 适用场景
1. **文本预处理**: 为后续处理准备标准化的句子格式
2. **批量处理**: 处理大量文本文件的句子分割
3. **格式转换**: 将连续文本转换为每行一句的格式
4. **数据清洗**: 清理和标准化文本数据

### 处理顺序
建议在以下插件之后使用：
- TextCleaningPlugin: 基础文本清理
- PunctuationAdderPlugin: 标点符号恢复

## 注意事项

### 使用建议
1. **预处理**: 建议先用 TextCleaningPlugin 清理文本
2. **标点符号**: 确保文本包含适当的标点符号
3. **缩写词**: 根据需要调整缩写词模式列表
4. **性能**: 对于大文件，考虑分批处理

### 限制说明
1. **语言支持**: 主要针对英文文本优化
2. **复杂句子**: 对于复杂的长句，可能需要后续的 SentenceSplitterPlugin
3. **标点依赖**: 依赖标点符号进行分割，无标点文本无法处理

## 故障排除

### 常见问题

1. **句子分割不准确**
   - 检查标点符号是否正确
   - 确认缩写词模式是否完整
   - 调整句子结束标点符号列表

2. **缩写词误分割**
   - 添加新的缩写词模式
   - 检查单字母缩写识别规则
   - 调整缩写词处理逻辑

3. **空白字符问题**
   - 启用空白字符规范化
   - 检查输入文本格式
   - 调整预处理规则
